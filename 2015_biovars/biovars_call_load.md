Title
========================================================

This is an R Markdown document. Markdown is a simple formatting syntax for authoring web pages (click the **Help** toolbar button for more details on using R Markdown).

When you click the **Knit HTML** button a web page will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```r
library(maptools)
```

```
## Warning: package 'maptools' was built under R version 3.1.3
```

```
## Loading required package: sp
```

```
## Warning: package 'sp' was built under R version 3.1.2
```

```
## Checking rgeos availability: FALSE
##  	Note: when rgeos is not available, polygon geometry 	computations in maptools depend on gpclib,
##  	which has a restricted licence. It is disabled by default;
##  	to enable gpclib, type gpclibPermit()
## 
## Attaching package: 'maptools'
## 
## The following object is masked from 'package:sp':
## 
##     nowrapSpatialLines
```

```r
library(raster)
```

```
## Warning: package 'raster' was built under R version 3.1.2
```

```r
library(dismo)
```

```
## Warning: package 'dismo' was built under R version 3.1.2
```

```r
#my_path <- 'C:\\Users\\Viacheslav\\Downloads\\Aster\\bioclim_CA\\'
my_path <- 'C:\\Users\\Viacheslav\\Google Drive\\Projects_actual\\geo_BioclimInterpolation_Occidente\\Bioclim_a100\\'

obs_points <- read.csv("A._flinckii_formato_MaxEnt.csv")

obs_points
```

```
##            Specie Latitud Longitud
## 1  Abies_flinckii 19.3510 -101.366
## 2  Abies_flinckii 19.3216 -101.398
## 3  Abies_flinckii 19.8801 -100.711
## 4  Abies_flinckii 19.6934 -100.911
## 5  Abies_flinckii 19.6971 -100.913
## 6  Abies_flinckii 19.3630 -102.270
## 7  Abies_flinckii 19.6808 -100.894
## 8  Abies_flinckii 19.6683 -100.909
## 9  Abies_flinckii 19.6570 -100.797
## 10 Abies_flinckii 18.7029 -102.970
## 11 Abies_flinckii 19.5933 -104.293
## 12 Abies_flinckii 19.5735 -104.267
## 13 Abies_flinckii 19.5599 -104.151
## 14 Abies_flinckii 19.5786 -104.214
## 15 Abies_flinckii 19.5664 -104.254
## 16 Abies_flinckii 19.5946 -104.184
## 17 Abies_flinckii 19.5145 -104.229
## 18 Abies_flinckii 19.5335 -104.226
## 19 Abies_flinckii 19.5814 -104.203
## 20 Abies_flinckii 19.5614 -104.227
## 21 Abies_flinckii 19.5756 -104.256
## 22 Abies_flinckii 19.5841 -104.250
## 23 Abies_flinckii 19.5481 -104.186
## 24 Abies_flinckii 19.5578 -104.237
## 25 Abies_flinckii 19.5499 -104.221
## 26 Abies_flinckii 19.5674 -104.216
## 27 Abies_flinckii 19.6176 -103.635
## 28 Abies_flinckii 19.4674 -103.949
## 29 Abies_flinckii 19.5888 -103.561
## 30 Abies_flinckii 19.5570 -103.563
## 31 Abies_flinckii 19.5519 -103.565
## 32 Abies_flinckii 19.5473 -103.714
## 33 Abies_flinckii 19.6349 -103.604
## 34 Abies_flinckii 19.5972 -103.570
## 35 Abies_flinckii 19.6223 -103.629
## 36 Abies_flinckii 19.6172 -103.584
## 37 Abies_flinckii 19.6231 -103.631
## 38 Abies_flinckii 19.6270 -103.634
## 39 Abies_flinckii 19.6218 -103.594
## 40 Abies_flinckii 19.6207 -103.602
## 41 Abies_flinckii 19.6483 -103.623
## 42 Abies_flinckii 19.6070 -103.570
## 43 Abies_flinckii 19.6433 -103.615
## 44 Abies_flinckii 19.6353 -103.602
## 45 Abies_flinckii 19.6088 -103.626
## 46 Abies_flinckii 19.6330 -103.641
## 47 Abies_flinckii 18.7810 -102.941
## 48 Abies_flinckii 19.6786 -100.905
## 49 Abies_flinckii 19.6833 -100.883
## 50 Abies_flinckii 19.6558 -103.634
```

```r
obs_points_xy <- data.frame(cbind(obs_points[,3],obs_points[,2]))
colnames(obs_points_xy) <- c('x','y')

data(wrld_simpl)
plot(wrld_simpl, xlim=c(-110,-60), ylim=c(0,30), axes=TRUE, col="lightyellow")

points(obs_points$Longitud, obs_points$Latitud, col="red", cex=0.75)
```

![plot of chunk unnamed-chunk-1](figure/unnamed-chunk-1-1.png) 


```r
b <- stack(paste(my_path,"biovars_occidente_a1min.tif",sep=""))

names(b) <- c(paste('b',1:19,sep=""))
b
```

```
## class       : RasterStack 
## dimensions  : 368, 371, 136528, 19  (nrow, ncol, ncell, nlayers)
## resolution  : 0.016667, 0.016666  (x, y)
## extent      : -107.0093, -100.8258, 16.95012, 23.08321  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 
## names       :         b1,         b2,         b3,         b4,         b5,         b6,         b7,         b8,         b9,        b10,        b11,        b12,        b13,        b14,        b15, ... 
## min values  :   68.28463,   95.66667,   55.14500,  541.22832,  155.91046,  -17.47172,  136.39751,   77.53442,   61.68777,   86.45466,   47.45741,  203.68608,   33.75415,    0.00000,   59.79518, ... 
## max values  :  295.11619,  197.95850,   85.32609, 3822.04370,  412.00000,  209.64537,  306.49799,  303.00000,  297.38472,  318.54283,  273.13150, 2166.63542,  695.58090,   13.29448,  142.37447, ...
```

```r
summary(b)
```

```
## Warning in .local(object, ...): summary is an estimate based on a sample of 1e+05 cells (73.25% of all cells)
```

```
##                  b1          b2          b3         b4         b5
## Min.       68.28463    95.66667    55.24477   541.2283   155.9105
## 1st Qu.   171.13087   140.90539    63.06938  1885.8542   293.0504
## Median    192.60037   153.56368    64.67043  2512.5196   312.0628
## 3rd Qu.   235.81112   163.79876    66.90337  2794.0579   332.2584
## Max.      294.81231   197.72508    85.32609  3822.0437   412.0000
## NA's    56719.00000 56719.00000 56719.00000 56719.0000 56719.0000
##                  b6         b7          b8          b9         b10
## Min.      -17.47172   136.3975    77.53442    61.68777    86.45466
## 1st Qu.    39.79307   211.8076   192.27293   162.02091   200.37406
## Median     67.00000   238.0803   213.06767   186.33253   220.21437
## 3rd Qu.   126.26934   256.2619   250.27641   227.94643   257.93849
## Max.      209.64537   306.2490   302.73785   297.38472   318.54283
## NA's    56719.00000 56719.0000 56719.00000 56719.00000 56719.00000
##                 b11        b12         b13          b14         b15
## Min.       47.45741   203.6861    33.75415     0.000000    59.83207
## 1st Qu.   134.86756   662.5133   158.27558     2.747814   102.57256
## Median    158.81283   851.5611   212.69362     4.000000   109.15755
## 3rd Qu.   208.37654  1062.5433   263.09428     6.000000   114.73442
## Max.      273.08877  2166.6354   695.58090    13.294484   142.37447
## NA's    56719.00000 56719.0000 56719.00000 56719.000000 56719.00000
##                 b16         b17         b18         b19
## Min.       96.25883     3.00000    80.96214    14.00000
## 1st Qu.   421.01251    14.00000   198.56174    32.48716
## Median    558.72337    19.55534   292.02145    40.00000
## 3rd Qu.   700.73574    24.51723   435.65966    50.76837
## Max.     1763.09193    57.91881  1685.13916   187.49809
## NA's    56719.00000 56719.00000 56719.00000 56719.00000
```

```r
mask_reclass_table <- matrix(c(-Inf, Inf, 1), ncol=3, byrow=TRUE)
b_mask <- reclassify(subset(b,1),mask_reclass_table)

#b_mask <- mask(subset(b,1),subset(b,1),updatevalue=1)

plot(b_mask)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2-1.png) 

```r
plot(b,c(1:9), nc=3)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2-2.png) 

```r
plot(b,c(10:18), nc=3)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2-3.png) 

```r
plot(b,c(19), nc=3)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2-4.png) 

Guardando raster con 19 variables bioclimÃ¡ticas


```r
set.seed(0)
random_bg <- randomPoints(b_mask, 1000)

plot(wrld_simpl, xlim=c(-110,-60), ylim=c(0,30), axes=TRUE, col="lightyellow")
points(random_bg, cex=0.5, col="blue")
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3-1.png) 

```r
pb <- c(rep(1, nrow(obs_points_xy)), rep(0, nrow(random_bg)))
all_points_xy <- data.frame(cbind(pb, rbind(obs_points_xy, random_bg)))

all_vals <- extract(b, all_points_xy[,2:3])

all_vals_xy <- data.frame(cbind(all_points_xy, all_vals))
all_vals_xy <- na.omit(all_vals_xy)

pairs(all_vals_xy[all_vals_xy$pb==1,4:22], cex=0.1, fig=TRUE)
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3-2.png) 

```r
train_test <- sample(nrow(all_vals_xy), round(0.75 * nrow(all_vals_xy)))
traindata <- all_vals_xy[train_test,]
traindata[traindata$pb==1,]
```

```
##    pb        x       y       b1       b2       b3       b4       b5
## 31  1 -103.565 19.5519 129.9178 127.7824 62.67308 1995.622 230.7774
## 20  1 -104.227 19.5614 163.6112 129.4957 65.48148 1600.714 259.4678
## 5   1 -100.913 19.6971 145.8580 142.0714 65.90077 1870.034 253.4700
## 44  1 -103.602 19.6353 151.1634 136.8511 63.69075 2019.699 256.1879
## 21  1 -104.256 19.5756 166.1646 130.3282 65.73175 1588.267 262.3828
## 46  1 -103.641 19.6330 136.9185 129.6847 62.62404 2048.401 239.9228
## 41  1 -103.623 19.6483 145.1142 133.6319 63.00897 2064.006 249.4148
## 33  1 -103.604 19.6349 151.1634 136.8511 63.69075 2019.699 256.1879
## 32  1 -103.714 19.5473 186.7499 142.4468 66.41571 1687.836 289.3866
## 24  1 -104.237 19.5578 163.6112 129.4957 65.48148 1600.714 259.4678
## 39  1 -103.594 19.6218 136.5260 130.1598 62.60918 2068.373 239.5212
## 15  1 -104.254 19.5664 174.3455 132.0864 66.30786 1543.001 270.8275
## 29  1 -103.561 19.5888 122.5168 125.4619 62.29665 2015.027 222.7996
## 48  1 -100.905 19.6786 142.8005 141.5562 66.07989 1850.848 249.1716
## 1   1 -101.366 19.3510 134.4728 137.9268 67.35505 1664.865 239.2847
## 14  1 -104.214 19.5786 168.2034 131.2674 65.79703 1578.368 264.8743
## 47  1 -102.941 18.7810 149.2971 126.2365 65.73933 1538.305 240.6566
## 40  1 -103.602 19.6207 136.5260 130.1598 62.60918 2068.373 239.5212
## 27  1 -103.635 19.6176 136.9185 129.6847 62.62404 2048.401 239.9228
## 37  1 -103.631 19.6231 136.9185 129.6847 62.62404 2048.401 239.9228
## 4   1 -100.911 19.6934 145.8580 142.0714 65.90077 1870.034 253.4700
## 16  1 -104.184 19.5946 151.8049 126.8585 64.22928 1719.836 248.7094
## 19  1 -104.203 19.5814 150.6399 126.0305 64.27640 1699.869 246.7291
## 6   1 -102.270 19.3630 148.0312 145.5054 65.76390 1905.579 256.2579
## 8   1 -100.909 19.6683 142.8005 141.5562 66.07989 1850.848 249.1716
## 49  1 -100.883 19.6833 139.0493 141.1527 66.68421 1826.695 243.3174
## 30  1 -103.563 19.5570 129.9178 127.7824 62.67308 1995.622 230.7774
## 35  1 -103.629 19.6223 136.9185 129.6847 62.62404 2048.401 239.9228
## 13  1 -104.151 19.5599 124.6846 118.5055 62.36439 1798.604 219.2574
## 43  1 -103.615 19.6433 145.1142 133.6319 63.00897 2064.006 249.4148
## 10  1 -102.970 18.7029 134.4760 121.6294 65.85999 1457.655 222.7136
## 45  1 -103.626 19.6088 119.6856 123.6429 62.12530 1995.853 219.2984
## 50  1 -103.634 19.6558 151.5156 136.3408 63.54958 2026.143 256.5550
## 7   1 -100.894 19.6808 142.8005 141.5562 66.07989 1850.848 249.1716
## 25  1 -104.221 19.5499 141.3287 122.6470 63.56512 1718.383 235.9665
## 36  1 -103.584 19.6172 147.2476 135.2006 63.38054 2047.237 251.9209
##          b6       b7       b8       b9      b10       b11       b12
## 31 26.91181 203.8656 143.5861 121.8189 151.8235 102.89792 1107.1620
## 20 61.71033 197.7575 173.6023 155.8358 181.0558 141.66961 1268.2670
## 5  37.87845 215.5915 154.1553 144.0608 167.2334 119.57837 1170.8144
## 44 41.32312 214.8648 169.6030 142.6840 172.8899 123.57259  985.8314
## 21 64.11232 198.2704 176.1153 158.0780 183.5330 144.42540 1280.1619
## 46 32.84620 207.0766 153.0827 129.1822 159.4731 109.27394 1057.8177
## 41 37.33588 212.0789 163.8084 137.0551 167.5488 117.02658 1016.5506
## 33 41.32312 214.8648 169.6030 142.6840 172.8899 123.57259  985.8314
## 32 74.90810 214.4785 197.6905 178.5236 204.4833 163.02721  672.2588
## 24 61.71033 197.7575 173.6023 155.8358 181.0558 141.66961 1268.2670
## 39 31.63466 207.8866 153.0376 128.6318 159.2270 108.62826 1057.7724
## 15 71.64110 199.1864 183.8223 166.1285 191.1985 153.26457 1319.8645
## 29 21.40806 201.3915 135.9724 114.9002 144.9281  95.51265 1126.3782
## 48 34.93856 214.2330 151.6051 140.3417 163.5505 116.60641 1223.8179
## 1  34.50821 204.7765 141.7142 132.2314 153.7730 111.46949 1360.8525
## 14 65.37397 199.5003 177.9086 160.1824 185.4098 146.60072 1257.0795
## 47 48.63096 192.0257 159.9778 141.2378 165.7303 127.93886 1331.1372
## 40 31.63466 207.8866 153.0376 128.6318 159.2270 108.62826 1057.7724
## 27 32.84620 207.0766 153.0827 129.1822 159.4731 109.27394 1057.8177
## 37 32.84620 207.0766 153.0827 129.1822 159.4731 109.27394 1057.8177
## 4  37.87845 215.5915 154.1553 144.0608 167.2334 119.57837 1170.8144
## 16 51.20876 197.5006 162.6665 144.2843 170.7937 128.44399 1215.1866
## 19 50.67888 196.0502 161.3788 143.1372 169.3777 127.61217 1234.1594
## 6  35.00080 221.2571 160.0187 142.6334 168.7205 122.13525 1099.9945
## 8  34.93856 214.2330 151.6051 140.3417 163.5505 116.60641 1223.8179
## 49 31.63325 211.6841 148.4979 135.8897 159.0095 112.98940 1275.5307
## 30 26.91181 203.8656 143.5861 121.8189 151.8235 102.89792 1107.1620
## 35 32.84620 207.0766 153.0827 129.1822 159.4731 109.27394 1057.8177
## 13 29.23625 190.0211 136.2108 117.0801 144.8775 100.61490 1253.6785
## 43 37.33588 212.0789 163.8084 137.0551 167.5488 117.02658 1016.5506
## 10 38.03341 184.6802 144.6012 126.8675 150.1086 114.24514 1374.0233
## 45 20.28002 199.0184 132.8017 112.1178 142.0495  92.99618 1138.7211
## 50 42.01282 214.5422 169.5445 143.5073 173.1242 123.70963  981.7004
## 7  34.93856 214.2330 151.6051 140.3417 163.5505 116.60641 1223.8179
## 25 43.02985 192.9367 152.2351 133.6089 160.4162 118.06161 1257.8937
## 36 38.61397 213.3070 165.9853 138.7031 169.4341 119.37824 1010.6637
##         b13       b14       b15      b16      b17      b18      b19
## 31 224.0124  7.734993  97.17602 646.0371 26.45347 465.8817 54.90764
## 20 273.1692  5.763887 102.13607 786.5121 25.76389 499.1820 70.00000
## 5  256.2359  9.232614  99.84791 704.7987 44.15571 285.9063 52.15571
## 44 194.8199  8.000000  95.03576 560.6577 24.73524 421.1103 51.23558
## 21 278.3828  5.735889 102.86160 798.5299 25.47178 504.3416 69.73589
## 46 210.3420  8.000000  96.07679 606.2823 26.22260 448.0091 54.43676
## 41 200.3289  8.000000  95.37817 579.0366 25.23560 432.9724 52.73526
## 33 194.8199  8.000000  95.03576 560.6577 24.73524 421.1103 51.23558
## 32 150.9483  3.507900  98.17151 406.1430 12.03694 286.7379 38.59758
## 24 273.1692  5.763887 102.13607 786.5121 25.76389 499.1820 70.00000
## 39 211.2647  8.000000  96.32374 607.8232 26.21412 449.6507 53.68520
## 15 294.4845  5.264152 105.31223 842.2146 24.76444 517.8418 69.50028
## 29 228.2385  8.000000  96.93831 657.4801 28.19731 473.1414 57.88637
## 48 267.1777  9.753396  99.88183 735.7306 46.27255 299.4440 53.78721
## 1  288.9694  8.000000 101.63155 827.4218 37.74589 314.4612 56.74589
## 14 273.3611  5.735847 102.56604 782.4739 25.47169 496.2811 69.23556
## 47 285.2677  3.732284 105.46535 843.0709 14.46457 541.7076 39.69734
## 40 211.2647  8.000000  96.32374 607.8232 26.21412 449.6507 53.68520
## 27 210.3420  8.000000  96.07679 606.2823 26.22260 448.0091 54.43676
## 37 210.3420  8.000000  96.07679 606.2823 26.22260 448.0091 54.43676
## 4  256.2359  9.232614  99.84791 704.7987 44.15571 285.9063 52.15571
## 16 252.7297  6.742914  99.13465 731.4449 26.74291 483.7429 69.74291
## 19 257.5580  6.742854  99.58028 747.0663 26.74285 489.2010 71.22153
## 6  243.0084  2.255236 106.12204 684.7571 19.49960 490.2509 30.74295
## 8  267.1777  9.753396  99.88183 735.7306 46.27255 299.4440 53.78721
## 49 278.3947 10.000000  99.88428 766.3964 48.57783 311.8739 56.33121
## 30 224.0124  7.734993  97.17602 646.0371 26.45347 465.8817 54.90764
## 35 210.3420  8.000000  96.07679 606.2823 26.22260 448.0091 54.43676
## 13 256.2286  8.742877  97.57203 749.4362 30.74288 496.7355 75.24974
## 43 200.3289  8.000000  95.37817 579.0366 25.23560 432.9724 52.73526
## 10 290.5616  5.025974 103.45001 857.5978 18.34477 552.4579 46.11310
## 45 230.1805  8.243299  96.49837 664.3027 29.72990 475.1621 61.22494
## 50 191.1888  8.000000  94.16781 554.5535 25.00000 418.3775 53.00000
## 7  267.1777  9.753396  99.88183 735.7306 46.27255 299.4440 53.78721
## 25 260.2296  7.264234  99.23801 760.7305 27.79270 496.0717 72.55665
## 36 201.0791  7.735177  95.87948 577.4720 24.47035 431.4144 51.00000
```

```r
testdata <- all_vals_xy[-train_test,]
testdata[testdata$pb==1,]
```

```
##    pb        x       y       b1       b2       b3       b4       b5
## 2   1 -101.398 19.3216 155.1446 146.4294 67.95308 1761.455 265.9500
## 11  1 -104.293 19.5933 178.0229 133.1741 66.42992 1531.263 274.3895
## 12  1 -104.267 19.5735 176.6579 132.7827 66.23847 1541.673 273.2891
## 17  1 -104.229 19.5145 181.6594 133.1922 66.85248 1485.215 277.1671
## 18  1 -104.226 19.5335 176.2588 132.4161 66.21293 1529.462 272.6770
## 22  1 -104.250 19.5841 164.6642 130.1901 65.33939 1614.040 261.4272
## 23  1 -104.186 19.5481 173.8196 132.4511 66.23060 1545.831 270.4385
## 26  1 -104.216 19.5674 168.2034 131.2674 65.79703 1578.368 264.8743
## 28  1 -103.949 19.4674 145.5170 126.2283 63.99831 1767.310 241.9277
## 34  1 -103.570 19.5972 122.5168 125.4619 62.29665 2015.027 222.7996
## 38  1 -103.634 19.6270 136.9185 129.6847 62.62404 2048.401 239.9228
## 42  1 -103.570 19.6070 138.3623 131.4959 62.79532 2056.981 241.5505
##          b6       b7       b8       b9      b10       b11      b12
## 2  50.46341 215.4865 162.3432 153.9634 176.1697 131.50062 1261.624
## 11 73.92372 200.4658 187.3357 169.4456 194.7478 157.08324 1359.671
## 12 72.84457 200.4445 185.8260 168.3038 193.5345 155.55808 1336.173
## 17 77.93804 199.2290 190.5206 173.2240 197.8039 161.26134 1361.954
## 18 72.69820 199.9788 185.4587 167.8590 192.8708 155.28682 1320.071
## 22 62.17773 199.2495 174.6867 156.6869 182.3177 142.54984 1270.523
## 23 70.45966 199.9788 183.2036 165.8598 190.6669 152.53137 1255.867
## 26 65.37397 199.5003 177.9086 160.1824 185.4098 146.60072 1257.080
## 28 44.69209 197.2356 157.0527 137.8135 164.8062 121.38714 1153.145
## 34 21.40806 201.3915 135.9724 114.9002 144.9281  95.51265 1126.378
## 38 32.84620 207.0766 153.0827 129.1822 159.4731 109.27394 1057.818
## 42 32.18084 209.3697 153.6823 130.0597 160.8488 110.48279 1053.478
##         b13      b14       b15      b16      b17      b18      b19
## 2  269.7458 7.000000 104.00825 773.5416 28.78175 290.2862 49.53659
## 11 308.3619 5.000000 106.74752 876.5586 24.23627 535.1409 71.47254
## 12 300.6555 5.264090 105.91894 856.5175 25.24305 525.4631 70.73647
## 17 309.1229 4.742654 107.63269 888.1454 24.00000 528.6595 68.51469
## 18 294.7931 5.000000 105.57426 845.0547 24.49334 516.5655 69.22275
## 22 274.8927 6.000000 102.26801 787.7214 25.75745 502.1791 70.00000
## 23 276.2136 5.521480 103.75103 791.6172 24.28546 493.1205 67.25720
## 26 273.3611 5.735847 102.56604 782.4739 25.47169 496.2811 69.23556
## 28 231.5144 7.264730  97.24750 681.0357 25.26473 462.8223 63.02914
## 34 228.2385 8.000000  96.93831 657.4801 28.19731 473.1414 57.88637
## 38 210.3420 8.000000  96.07679 606.2823 26.22260 448.0091 54.43676
## 42 211.7309 7.491740  96.73809 607.6629 24.95406 448.2637 52.68987
```

```r
bc_model <- bioclim(traindata[traindata$pb==1,4:22])

str(bc_model)
```

```
## Formal class 'Bioclim' [package "dismo"] with 5 slots
##   ..@ min       : Named num [1:19] 119.7 118.5 62.1 1457.7 219.3 ...
##   .. ..- attr(*, "names")= chr [1:19] "b1" "b2" "b3" "b4" ...
##   ..@ max       : Named num [1:19] 186.7 145.5 67.4 2068.4 289.4 ...
##   .. ..- attr(*, "names")= chr [1:19] "b1" "b2" "b3" "b4" ...
##   ..@ presence  :'data.frame':	36 obs. of  19 variables:
##   .. ..$ b1 : num [1:36] 130 164 146 151 166 ...
##   .. ..$ b2 : num [1:36] 128 129 142 137 130 ...
##   .. ..$ b3 : num [1:36] 62.7 65.5 65.9 63.7 65.7 ...
##   .. ..$ b4 : num [1:36] 1996 1601 1870 2020 1588 ...
##   .. ..$ b5 : num [1:36] 231 259 253 256 262 ...
##   .. ..$ b6 : num [1:36] 26.9 61.7 37.9 41.3 64.1 ...
##   .. ..$ b7 : num [1:36] 204 198 216 215 198 ...
##   .. ..$ b8 : num [1:36] 144 174 154 170 176 ...
##   .. ..$ b9 : num [1:36] 122 156 144 143 158 ...
##   .. ..$ b10: num [1:36] 152 181 167 173 184 ...
##   .. ..$ b11: num [1:36] 103 142 120 124 144 ...
##   .. ..$ b12: num [1:36] 1107 1268 1171 986 1280 ...
##   .. ..$ b13: num [1:36] 224 273 256 195 278 ...
##   .. ..$ b14: num [1:36] 7.73 5.76 9.23 8 5.74 ...
##   .. ..$ b15: num [1:36] 97.2 102.1 99.8 95 102.9 ...
##   .. ..$ b16: num [1:36] 646 787 705 561 799 ...
##   .. ..$ b17: num [1:36] 26.5 25.8 44.2 24.7 25.5 ...
##   .. ..$ b18: num [1:36] 466 499 286 421 504 ...
##   .. ..$ b19: num [1:36] 54.9 70 52.2 51.2 69.7 ...
##   ..@ absence   :'data.frame':	0 obs. of  0 variables
##   ..@ hasabsence: logi FALSE
```

```r
response(bc_model)
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3-3.png) 

```r
plot(bc_model, a=4, b=5, p=0.85)
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3-4.png) 

```r
pb <- predict(b, bc_model, progress='text')
```

```
##   |                                                                         |                                                                 |   0%  |                                                                         |================                                                 |  25%  |                                                                         |================================                                 |  50%  |                                                                         |=================================================                |  75%  |                                                                         |=================================================================| 100%
## 
```

```r
pb
```

```
## class       : RasterLayer 
## dimensions  : 368, 371, 136528  (nrow, ncol, ncell)
## resolution  : 0.016667, 0.016666  (x, y)
## extent      : -107.0093, -100.8258, 16.95012, 23.08321  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 
## data source : in memory
## names       : layer 
## values      : 0, 0.5  (min, max)
```

```r
plot(pb, main='Bioclim model')
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3-5.png) 



```r
e <- evaluate(testdata[testdata$pb==1,], testdata[testdata$pb==0,], bc_model)
e
```

```
## class          : ModelEvaluation 
## n presences    : 12 
## n absences     : 250 
## AUC            : 0.7905 
## cor            : 0.679798 
## max TPR+TNR at : 0.08323333
```

```r
#str(e)

par(mfrow=c(1, 3))

plot(e, 'ROC')

density(e)
boxplot(e, col=c('blue','red'))
```

```
## Warning in bxp(structure(list(stats = structure(c(0, 0, 0, 0, 0, 0, 0,
## 0.0972222222222222, : some notches went outside hinges ('box'): maybe set
## notch=FALSE
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4-1.png) 

```r
test_presence <- extract(pb,testdata[testdata$pb==1,2:3])
test_absence <- extract(pb,testdata[testdata$pb==0,2:3])

test_pb = c(rep('presence', length(test_presence)), rep('absence', length(test_absence)))
test_points <- data.frame(cbind(test_pb, c(test_presence,test_absence)))
test_points[,1] <- as.factor(test_points[,1])

test_points
```

```
##      test_pb                 V2
## 1   presence                  0
## 2   presence                  0
## 3   presence                  0
## 4   presence                  0
## 5   presence                  0
## 6   presence  0.222222222222222
## 7   presence  0.111111111111111
## 8   presence  0.138888888888889
## 9   presence  0.277777777777778
## 10  presence 0.0833333333333333
## 11  presence  0.333333333333333
## 12  presence  0.222222222222222
## 13   absence                  0
## 14   absence                  0
## 15   absence                  0
## 16   absence                  0
## 17   absence                  0
## 18   absence                  0
## 19   absence                  0
## 20   absence                  0
## 21   absence                  0
## 22   absence                  0
## 23   absence                  0
## 24   absence                  0
## 25   absence                  0
## 26   absence                  0
## 27   absence                  0
## 28   absence                  0
## 29   absence                  0
## 30   absence                  0
## 31   absence                  0
## 32   absence                  0
## 33   absence                  0
## 34   absence                  0
## 35   absence                  0
## 36   absence                  0
## 37   absence                  0
## 38   absence                  0
## 39   absence                  0
## 40   absence                  0
## 41   absence                  0
## 42   absence                  0
## 43   absence                  0
## 44   absence                  0
## 45   absence                  0
## 46   absence                  0
## 47   absence                  0
## 48   absence                  0
## 49   absence                  0
## 50   absence                  0
## 51   absence                  0
## 52   absence                  0
## 53   absence                  0
## 54   absence                  0
## 55   absence                  0
## 56   absence                  0
## 57   absence                  0
## 58   absence                  0
## 59   absence                  0
## 60   absence                  0
## 61   absence                  0
## 62   absence                  0
## 63   absence                  0
## 64   absence                  0
## 65   absence                  0
## 66   absence                  0
## 67   absence                  0
## 68   absence                  0
## 69   absence                  0
## 70   absence                  0
## 71   absence  0.111111111111111
## 72   absence                  0
## 73   absence                  0
## 74   absence                  0
## 75   absence                  0
## 76   absence                  0
## 77   absence                  0
## 78   absence                  0
## 79   absence                  0
## 80   absence                  0
## 81   absence                  0
## 82   absence                  0
## 83   absence                  0
## 84   absence                  0
## 85   absence                  0
## 86   absence                  0
## 87   absence                  0
## 88   absence                  0
## 89   absence                  0
## 90   absence                  0
## 91   absence                  0
## 92   absence                  0
## 93   absence                  0
## 94   absence                  0
## 95   absence                  0
## 96   absence                  0
## 97   absence                  0
## 98   absence                  0
## 99   absence                  0
## 100  absence                  0
## 101  absence                  0
## 102  absence                  0
## 103  absence                  0
## 104  absence                  0
## 105  absence                  0
## 106  absence                  0
## 107  absence                  0
## 108  absence                  0
## 109  absence                  0
## 110  absence                  0
## 111  absence                  0
## 112  absence                  0
## 113  absence                  0
## 114  absence                  0
## 115  absence                  0
## 116  absence                  0
## 117  absence                  0
## 118  absence                  0
## 119  absence                  0
## 120  absence                  0
## 121  absence                  0
## 122  absence                  0
## 123  absence                  0
## 124  absence                  0
## 125  absence                  0
## 126  absence                  0
## 127  absence                  0
## 128  absence                  0
## 129  absence                  0
## 130  absence                  0
## 131  absence                  0
## 132  absence                  0
## 133  absence                  0
## 134  absence                  0
## 135  absence                  0
## 136  absence                  0
## 137  absence                  0
## 138  absence                  0
## 139  absence                  0
## 140  absence                  0
## 141  absence                  0
## 142  absence                  0
## 143  absence                  0
## 144  absence                  0
## 145  absence                  0
## 146  absence                  0
## 147  absence                  0
## 148  absence                  0
## 149  absence                  0
## 150  absence                  0
## 151  absence                  0
## 152  absence                  0
## 153  absence                  0
## 154  absence                  0
## 155  absence                  0
## 156  absence                  0
## 157  absence                  0
## 158  absence                  0
## 159  absence                  0
## 160  absence                  0
## 161  absence                  0
## 162  absence                  0
## 163  absence                  0
## 164  absence                  0
## 165  absence                  0
## 166  absence                  0
## 167  absence                  0
## 168  absence                  0
## 169  absence                  0
## 170  absence                  0
## 171  absence                  0
## 172  absence                  0
## 173  absence                  0
## 174  absence                  0
## 175  absence                  0
## 176  absence                  0
## 177  absence                  0
## 178  absence                  0
## 179  absence                  0
## 180  absence                  0
## 181  absence                  0
## 182  absence                  0
## 183  absence                  0
## 184  absence                  0
## 185  absence                  0
## 186  absence                  0
## 187  absence                  0
## 188  absence                  0
## 189  absence                  0
## 190  absence                  0
## 191  absence                  0
## 192  absence                  0
## 193  absence                  0
## 194  absence                  0
## 195  absence                  0
## 196  absence                  0
## 197  absence                  0
## 198  absence                  0
## 199  absence                  0
## 200  absence                  0
## 201  absence                  0
## 202  absence                  0
## 203  absence                  0
## 204  absence                  0
## 205  absence                  0
## 206  absence                  0
## 207  absence                  0
## 208  absence                  0
## 209  absence                  0
## 210  absence                  0
## 211  absence                  0
## 212  absence                  0
## 213  absence                  0
## 214  absence                  0
## 215  absence                  0
## 216  absence                  0
## 217  absence                  0
## 218  absence                  0
## 219  absence                  0
## 220  absence                  0
## 221  absence                  0
## 222  absence                  0
## 223  absence                  0
## 224  absence                  0
## 225  absence                  0
## 226  absence                  0
## 227  absence                  0
## 228  absence                  0
## 229  absence                  0
## 230  absence                  0
## 231  absence                  0
## 232  absence                  0
## 233  absence                  0
## 234  absence                  0
## 235  absence                  0
## 236  absence                  0
## 237  absence                  0
## 238  absence                  0
## 239  absence                  0
## 240  absence                  0
## 241  absence                  0
## 242  absence                  0
## 243  absence                  0
## 244  absence                  0
## 245  absence                  0
## 246  absence                  0
## 247  absence                  0
## 248  absence                  0
## 249  absence                  0
## 250  absence                  0
## 251  absence                  0
## 252  absence                  0
## 253  absence                  0
## 254  absence                  0
## 255  absence                  0
## 256  absence                  0
## 257  absence                  0
## 258  absence                  0
## 259  absence                  0
## 260  absence                  0
## 261  absence                  0
## 262  absence                  0
```

```r
boxplot(test_presence)

#if (require(rgdal)) {
#  rf <- writeRaster(b, filename=paste(my_path,"biovars.tif",sep=""), format="GTiff", overwrite=TRUE)
#}
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4-2.png) 

